<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>استمارة المعلومات للمسابقات</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f1f5f9;
            color: #0f172a;
        }
        .form-section {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
        }
        .section-header {
            background-color: #1e293b;
            color: white;
            padding: 0.7rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            display: inline-block;
            font-size: 1rem;
        }
        input, select, textarea {
            border: 2px solid #cbd5e1;
            padding: 0.8rem;
            border-radius: 0.6rem;
            width: 100%;
            margin-top: 0.4rem;
            transition: all 0.3s;
            font-weight: 600;
            background-color: #f8fafc;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #3b82f6;
            background-color: white;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
        }
        .label-title {
            font-weight: 700;
            color: #475569;
            display: block;
            font-size: 0.9rem;
            margin-right: 0.2rem;
        }
        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        const wilayas = [
            "01- أدرار", "02- الشلف", "03- الأغواط", "04- أم البواقي", "05- باتنة", "06- بجاية", "07- بسكرة", "08- بشار", "09- البليدة", "10- البويرة",
            "11- تمنراست", "12- تبسة", "13- تلمسان", "14- تيارت", "15- تيزي وزو", "16- الجزائر", "17- الجلفة", "18- جيجل", "19- سطيف", "20- سعيدة",
            "21- سكيكدة", "22- سيدي بلعباس", "23- عنابة", "24- قالمة", "25- قسنطينة", "26- المدية", "27- مستغانم", "28- المسيلة", "29- معسكر", "30- ورقلة",
            "31- وهران", "32- البيض", "33- إليزي", "34- برج بوعريريج", "35- بومرداس", "36- الطارف", "37- تندوف", "38- تسمسيلت", "39- الوادي", "40- خنشلة",
            "41- سوق أهراس", "42- تيبازة", "43- ميلة", "44- عين الدفلى", "45- النعامة", "46- عين تموشنت", "47- غرداية", "48- غليزان", "49- تيميمون", "50- برج باجي مختار",
            "51- أولاد جلال", "52- بني عباس", "53- عين صالح", "54- عين قزام", "55- تقرت", "56- جانت", "57- المغير", "58- المنيعة"
        ];

        const communesMap = {
            "03- الأغواط": ["الأغواط", "قصر الحيران", "بن ناصر بن شهرة", "سيدي مخلوف", "حاسي الدلاعة", "حاسي الرمل", "عين ماضي", "تاجموت", "الخنق", "قلتة سيدي سعد", "أفلو", "البيضاء", "سيدي بوزيد", "الغيشة", "بريدة", "الحويطة", "تاجرونة", "سبقاق", "تاويالة", "وادي مرة", "وادي مزي", "العسافية", "بن يعقوب", "عين سيدي علي"],
            "17- الجلفة": ["الجلفة", "عين وسارة", "حاسي بحبح", "مسعد", "الشارف", "بيرين", "دار الشيوخ", "حد الصحاري", "الإدريسية", "عين الإبل", "تعظميت", "سيدي لعجل"],
            "16- الجزائر": ["الجزائر الوسطى", "سيدي امحمد", "المدنية", "بلوزداد", "باب الوادي", "بولوغين", "بوزريعة", "بئر مراد رايس", "الحراش", "الدار البيضاء", "دالي إبراهيم", "الشراقة"],
            "default": ["بلدية أخرى (كتابة يدوية)"]
        };

        const App = () => {
            const [step, setStep] = useState(1);
            const [isSubmitting, setIsSubmitting] = useState(false);
            const [submitted, setSubmitted] = useState(false);

            const [formData, setFormData] = useState({
                directorate: '', requestedRank: '', teachingSubject: '',
                nin: '', lastNameAr: '', firstNameAr: '', lastNameLat: '', firstNameLat: '',
                fatherName: '', motherFirstName: '', motherLastName: '', birthDate: '',
                birthWilaya: '', birthCommune: '', birthCommuneManual: '', gender: '',
                maritalStatus: 'أعزب / عزباء', childrenCount: '0', 
                residenceWilaya: '', residenceCommune: '', residenceCommuneManual: '', fullAddress: '', phoneNumber: '',
                militaryStatus: '', docRefNum: '', docIssueDate: '', docEndDate: '', serviceStartDate: '', serviceEndDate: '',
                degreeName: '', specialty: '', degreeNum: '', graduationDate: '', issuingInstitution: '', trainingDuration: '', startYear: '', endYear: '', degreeGrade: '', 
                isEnsaGraduate: false, isFirstInClass: false, firstInClassDocNum: '', firstInClassDocDate: '', firstInClassIssuer: '',
                gpa: '', thesisGrade: '',
                semesters: Array(5).fill(null).map(() => ({ s1: '', s2: '', annual: '' })),
                otherDegreeName: '', otherDegreeSpecialty: '', otherDegreeIssuer: '', otherDegreeSemesters: '', otherDegreeFromYear: '', otherDegreeToYear: '',
                publicationNature: '', publicationDate: '', journalName: '', journalIssue: '', publicationLink: '',
                expJob: '', expInstitution: '', expApprovedDegree: '', expContractNum: '', expContractDate: '', expFrom: '', expTo: '', expEndReason: '',
                isEmployed: false, currentRank: '', firstAppointmentDate: '', rankAppointmentDate: '', currentGrade: '', adminRefNum: '', adminRefDate: '', signingAuthority: '', adminPhone: '', adminAddress: '',
                email: '', attachedDocs: []
            });

            // منطق التأشير التلقائي (Auto-checking)
            useEffect(() => {
                const docs = [];
                // بطاقة الإقامة
                if (formData.residenceWilaya && (formData.residenceCommune || formData.residenceCommuneManual)) {
                    docs.push("بطاقة الإقامة");
                }
                // الخدمة الوطنية
                if (formData.gender === 'male' && formData.militaryStatus) {
                    docs.push("وثيقة الخدمة الوطنية");
                }
                // الشهادة
                if (formData.degreeName && formData.degreeNum) {
                    docs.push("نسخة من الشهادة");
                }
                // كشوف النقاط
                if (formData.gpa || formData.semesters.some(s => s.annual)) {
                    docs.push("كشوف النقاط للمسار الدراسي");
                }
                // شهادات عليا ومنشورات
                if (formData.otherDegreeName || formData.publicationNature) {
                    docs.push("ملف المنشورات والشهادات العليا");
                }
                // شهادات عمل
                if (formData.expJob) {
                    docs.push("شهادات العمل (الخبرة)");
                }
                // ترخيص المشاركة
                if (formData.isEmployed) {
                    docs.push("ترخيص المشاركة (للموظفين)");
                }
                
                setFormData(prev => ({ ...prev, attachedDocs: docs }));
            }, [
                formData.residenceWilaya, formData.residenceCommune, formData.residenceCommuneManual,
                formData.gender, formData.militaryStatus, formData.degreeName, formData.degreeNum,
                formData.gpa, formData.semesters, formData.otherDegreeName, formData.publicationNature,
                formData.expJob, formData.isEmployed
            ]);

            const birthCommunes = useMemo(() => communesMap[formData.birthWilaya] || communesMap["default"], [formData.birthWilaya]);
            const residenceCommunes = useMemo(() => communesMap[formData.residenceWilaya] || communesMap["default"], [formData.residenceWilaya]);

            const handleChange = (e) => {
                const { name, value, type, checked } = e.target;
                if (name === 'nin' && !/^\d*$/.test(value)) return;
                if ((name === 'lastNameLat' || name === 'firstNameLat') && !/^[a-zA-Z\s]*$/.test(value)) return;
                setFormData(prev => ({ ...prev, [name]: type === 'checkbox' ? checked : value }));
            };

            const handleSemesterChange = (index, field, value) => {
                const newSemesters = [...formData.semesters];
                newSemesters[index] = { ...newSemesters[index], [field]: value };
                setFormData(prev => ({ ...prev, semesters: newSemesters }));
            };

            const generateReportText = () => {
                const finalBirth = formData.birthCommune === 'بلدية أخرى (كتابة يدوية)' ? formData.birthCommuneManual : formData.birthCommune;
                const finalResidence = formData.residenceCommune === 'بلدية أخرى (كتابة يدوية)' ? formData.residenceCommuneManual : formData.residenceCommune;

                let text = `=== معلومات المترشح للمسابقة ===\n\n`;
                text += `[المنصب المطلوب]\n`;
                text += `الولاية: ${formData.directorate}\nالرتبة: ${formData.requestedRank}\nالمادة: ${formData.teachingSubject}\n\n`;
                
                text += `[الهوية الشخصية]\n`;
                text += `الاسم: ${formData.firstNameAr}\nاللقب: ${formData.lastNameAr}\nالاسم (لاتيني): ${formData.firstNameLat}\nاللقب (لاتيني): ${formData.lastNameLat}\n`;
                text += `NIN: ${formData.nin}\nابن: ${formData.fatherName}\nالأم: ${formData.motherFirstName} ${formData.motherLastName}\n`;
                text += `الميلاد: ${formData.birthDate} في ${finalBirth} (${formData.birthWilaya})\n`;
                text += `الجنس: ${formData.gender === 'male' ? 'ذكر' : 'أنثى'}\nالحالة العائلية: ${formData.maritalStatus}\nالأولاد: ${formData.childrenCount}\n\n`;
                
                text += `[الإقامة والاتصال]\n`;
                text += `العنوان: ${formData.fullAddress}\nالبلدية: ${finalResidence}\nالولاية: ${formData.residenceWilaya}\nالهاتف: ${formData.phoneNumber}\nالبريد: ${formData.email}\n\n`;
                
                if(formData.gender === 'male') {
                    text += `[الخدمة الوطنية]\n`;
                    text += `الوضعية: ${formData.militaryStatus}\nرقم الوثيقة: ${formData.docRefNum}\nتاريخ الإصدار: ${formData.docIssueDate}\nتاريخ الانتهاء: ${formData.docEndDate}\nالفترة: من ${formData.serviceStartDate} إلى ${formData.serviceEndDate}\n\n`;
                }

                text += `[المؤهل العلمي]\n`;
                text += `الشهادة: ${formData.degreeName}\nالتخصص: ${formData.specialty}\nرقم الشهادة: ${formData.degreeNum}\nالتاريخ: ${formData.graduationDate}\nالمؤسسة: ${formData.issuingInstitution}\nالتقدير: ${formData.degreeGrade}\nخريج مدرسة عليا: ${formData.isEnsaGraduate ? 'نعم' : 'لا'}\nالأول في الدفعة: ${formData.isFirstInClass ? 'نعم' : 'لا'}\n`;
                text += `المعدل العام: ${formData.gpa}\nعلامة المذكرة: ${formData.thesisGrade}\n\n`;
                
                text += `[الخبرة المهنية]\n`;
                text += `الوظيفة: ${formData.expJob}\nالمؤسسة: ${formData.expInstitution}\nالفترة: من ${formData.expFrom} إلى ${formData.expTo}\nسبب المغادرة: ${formData.expEndReason}\n\n`;
                
                if(formData.isEmployed) {
                    text += `[الوظيفة الحالية]\n`;
                    text += `الرتبة: ${formData.currentRank}\nتاريخ التعيين: ${formData.firstAppointmentDate}\nالصنف والدرجة: ${formData.currentGrade}\nهاتف الإدارة: ${formData.adminPhone}\nالعنوان: ${formData.adminAddress}\n\n`;
                }

                text += `[الوثائق الملحقة]\n`;
                text += formData.attachedDocs.join(" | ") + `\n`;
                
                return text;
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsSubmitting(true);

                const reportContent = generateReportText();
                const reportBlob = new Blob([reportContent], { type: 'text/plain' });
                const reportFile = new File([reportBlob], "معلومات_المترشح.txt", { type: 'text/plain' });

                const form = new FormData();
                form.append("NIN", formData.nin);
                form.append("الاسم واللقب", `${formData.firstNameAr} ${formData.lastNameAr}`);
                form.append("الرتبة المطلوبة", formData.requestedRank);
                form.append("البريد الإلكتروني", formData.email);
                form.append("الملف_النصي_الكامل", reportFile); // إرسال الملف النصي كمرفق
                form.append("_subject", `طلب مشاركة: ${formData.firstNameAr} ${formData.lastNameAr}`);
                form.append("_template", "table");
                form.append("_captcha", "false");

                try {
                    const response = await fetch("https://formsubmit.co/ajax/ksarinfo.impr@gmail.com", {
                        method: "POST",
                        body: form
                    });
                    if (response.ok) setSubmitted(true);
                    else alert("يرجى تفعيل الاستمارة من بريدك الإلكتروني.");
                } catch {
                    alert("خطأ في الاتصال. حاول مرة أخرى.");
                } finally {
                    setIsSubmitting(false);
                }
            };

            if (submitted) {
                return (
                    <div className="min-h-screen flex items-center justify-center p-6 text-center animate-fade-in">
                        <div className="bg-white p-12 rounded-2xl shadow-2xl max-w-xl w-full border-t-8 border-green-600">
                            <div className="text-green-600 text-7xl mb-6">✓</div>
                            <h1 className="text-3xl font-black text-gray-800 mb-4">تم الإرسال بنجاح</h1>
                            <p className="text-gray-600 font-bold text-lg mb-8 leading-relaxed">شكراً {formData.firstNameAr}. تم إرسال كافة معلوماتك في ملف نصي شامل لضمان وصولها كاملة. يرجى مراجعة بريدك الإلكتروني لتأكيد الطلب إن لزم الأمر.</p>
                            <button onClick={() => window.location.reload()} className="bg-slate-800 text-white px-10 py-4 rounded-xl font-black hover:bg-slate-700 transition w-full shadow-lg">إرسال استمارة أخرى</button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="max-w-5xl mx-auto py-12 px-4">
                    <header className="mb-10 text-center bg-white border-b-8 border-slate-800 p-8 rounded-2xl shadow-xl">
                        <h1 className="text-3xl md:text-4xl font-black text-slate-800 mb-2">الاستمارة الإلكترونية للمسابقات</h1>
                        <p className="text-xl font-bold text-blue-600 italic">توظيف على أساس الشهادة</p>
                    </header>

                    <div className="mb-10 flex items-center justify-between text-xs md:text-sm font-black text-slate-400 gap-2 pb-2 overflow-x-auto whitespace-nowrap scrollbar-hide">
                        {[1, 2, 3, 4, 5, 6].map((s) => (
                            <div key={s} className={`flex-1 text-center pb-3 border-b-4 transition-all ${step >= s ? 'border-blue-600 text-blue-600' : 'border-slate-200'}`}>المرحلة {s}</div>
                        ))}
                    </div>

                    <form onSubmit={handleSubmit} className="space-y-6">
                        {step === 1 && (
                            <div className="animate-fade-in space-y-6">
                                <div className="form-section">
                                    <h2 className="section-header">1. بيانات المنصب والهوية</h2>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div><label className="label-title">مديرية التربية لولاية</label>
                                            <select name="directorate" required value={formData.directorate} onChange={handleChange}>
                                                <option value="">-- اختر الولاية --</option>
                                                {wilayas.map(w => <option key={w} value={w}>{w}</option>)}
                                            </select>
                                        </div>
                                        <div><label className="label-title">الرتبة المطلوبة</label>
                                            <select name="requestedRank" required value={formData.requestedRank} onChange={handleChange}>
                                                <option value="">-- اختر --</option>
                                                {["أستاذ مدرسة ابتدائية", "أستاذ تعليم متوسط", "أستاذ تعليم ثانوي"].map(r => <option key={r} value={r}>{r}</option>)}
                                            </select>
                                        </div>
                                        <div className="md:col-span-2"><label className="label-title">المادة</label><input type="text" name="teachingSubject" required value={formData.teachingSubject} onChange={handleChange} /></div>
                                        
                                        <div className="md:col-span-2"><label className="label-title">رقم التعريف الوطني (18 رقم)</label><input type="text" name="nin" maxLength="18" placeholder="000000000000000000" required value={formData.nin} onChange={handleChange} /></div>
                                        <div><label className="label-title">اللقب (عربي)</label><input type="text" name="lastNameAr" required value={formData.lastNameAr} onChange={handleChange} /></div>
                                        <div><label className="label-title">الاسم (عربي)</label><input type="text" name="firstNameAr" required value={formData.firstNameAr} onChange={handleChange} /></div>
                                        <div><label className="label-title">اللقب (LATIN)</label><input type="text" name="lastNameLat" dir="ltr" required value={formData.lastNameLat} onChange={handleChange} /></div>
                                        <div><label className="label-title">الاسم (LATIN)</label><input type="text" name="firstNameLat" dir="ltr" required value={formData.firstNameLat} onChange={handleChange} /></div>
                                        <div><label className="label-title">اسم الأب</label><input type="text" name="fatherName" required value={formData.fatherName} onChange={handleChange} /></div>
                                        <div className="grid grid-cols-2 gap-2">
                                            <div><label className="label-title">اسم الأم</label><input type="text" name="motherFirstName" required value={formData.motherFirstName} onChange={handleChange} /></div>
                                            <div><label className="label-title">لقب الأم</label><input type="text" name="motherLastName" required value={formData.motherLastName} onChange={handleChange} /></div>
                                        </div>
                                        <div><label className="label-title">تاريخ الميلاد</label><input type="date" name="birthDate" required value={formData.birthDate} onChange={handleChange} /></div>
                                        <div className="grid grid-cols-2 gap-2">
                                            <div><label className="label-title">ولاية الميلاد</label>
                                                <select name="birthWilaya" required value={formData.birthWilaya} onChange={handleChange}>
                                                    <option value="">-- اختر --</option>
                                                    {wilayas.map(w => <option key={w} value={w}>{w}</option>)}
                                                </select>
                                            </div>
                                            <div><label className="label-title">بلدية الميلاد</label>
                                                <select name="birthCommune" required value={formData.birthCommune} onChange={handleChange} disabled={!formData.birthWilaya}>
                                                    <option value="">-- اختر --</option>
                                                    {birthCommunes.map(c => <option key={c} value={c}>{c}</option>)}
                                                </select>
                                            </div>
                                        </div>
                                        {formData.birthCommune === 'بلدية أخرى (كتابة يدوية)' && (
                                            <div className="md:col-span-2"><label className="label-title animate-fade-in">اكتب بلدية الميلاد يدوياً</label><input type="text" name="birthCommuneManual" required value={formData.birthCommuneManual} onChange={handleChange} /></div>
                                        )}
                                        <div><label className="label-title">الجنس</label>
                                            <div className="flex gap-6 mt-3">
                                                <label className="flex items-center gap-2 font-bold cursor-pointer"><input type="radio" name="gender" value="male" checked={formData.gender === 'male'} onChange={handleChange} /> ذكر</label>
                                                <label className="flex items-center gap-2 font-bold cursor-pointer"><input type="radio" name="gender" value="female" checked={formData.gender === 'female'} onChange={handleChange} /> أنثى</label>
                                            </div>
                                        </div>
                                        <div><label className="label-title">الحالة العائلية</label>
                                            <select name="maritalStatus" required value={formData.maritalStatus} onChange={handleChange}>
                                                {["أعزب / عزباء", "متزوج(ة)", "مطلق(ة)", "أرمل(ة)"].map(m => <option key={m} value={m}>{m}</option>)}
                                            </select>
                                        </div>
                                        {formData.maritalStatus === 'متزوج(ة)' && (
                                            <div><label className="label-title animate-fade-in">عدد الأولاد</label><input type="number" name="childrenCount" min="0" value={formData.childrenCount} onChange={handleChange} /></div>
                                        )}

                                        <div className="md:col-span-2 border-t pt-4 mt-2">
                                            <h3 className="font-bold text-blue-700 mb-3 underline">معلومات السكن والاتصال:</h3>
                                        </div>
                                        <div className="grid grid-cols-2 gap-2">
                                            <div><label className="label-title">ولاية الإقامة</label>
                                                <select name="residenceWilaya" required value={formData.residenceWilaya} onChange={handleChange}>
                                                    <option value="">-- اختر --</option>
                                                    {wilayas.map(w => <option key={w} value={w}>{w}</option>)}
                                                </select>
                                            </div>
                                            <div><label className="label-title">بلدية الإقامة</label>
                                                <select name="residenceCommune" required value={formData.residenceCommune} onChange={handleChange} disabled={!formData.residenceWilaya}>
                                                    <option value="">-- اختر --</option>
                                                    {residenceCommunes.map(c => <option key={c} value={c}>{c}</option>)}
                                                </select>
                                            </div>
                                        </div>
                                        {formData.residenceCommune === 'بلدية أخرى (كتابة يدوية)' && (
                                            <div className="md:col-span-2"><label className="label-title animate-fade-in">اكتب بلدية الإقامة يدوياً</label><input type="text" name="residenceCommuneManual" required value={formData.residenceCommuneManual} onChange={handleChange} /></div>
                                        )}
                                        <div className="md:col-span-2"><label className="label-title">رقم الهاتف الشخصي</label><input type="text" name="phoneNumber" required value={formData.phoneNumber} onChange={handleChange} /></div>
                                        <div className="md:col-span-2"><label className="label-title">العنوان الكامل</label><input type="text" name="fullAddress" placeholder="الحي، الشارع، رقم الباب..." required value={formData.fullAddress} onChange={handleChange} /></div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {step === 2 && (
                            <div className="animate-fade-in space-y-6">
                                {formData.gender === 'male' && (
                                    <div className="form-section">
                                        <h2 className="section-header">2. الخدمة الوطنية (للذكور)</h2>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div className="md:col-span-2 flex flex-wrap gap-4">
                                                {["مؤدى", "معفى", "مؤجل"].map(s => <label key={s} className="flex items-center gap-2 font-bold p-3 border rounded-lg cursor-pointer bg-slate-50"><input type="radio" name="militaryStatus" value={s} checked={formData.militaryStatus === s} onChange={handleChange} /> {s}</label>)}
                                            </div>
                                            <div><label className="label-title">رقم الوثيقة</label><input type="text" name="docRefNum" value={formData.docRefNum} onChange={handleChange} /></div>
                                            <div className="grid grid-cols-2 gap-2">
                                                <div><label className="label-title">تاريخ الإصدار</label><input type="date" name="docIssueDate" value={formData.docIssueDate} onChange={handleChange} /></div>
                                                <div><label className="label-title">تاريخ الانتهاء</label><input type="date" name="docEndDate" value={formData.docEndDate} onChange={handleChange} /></div>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                <div className="form-section">
                                    <h2 className="section-header">3. الشهادة والمؤهل العلمي</h2>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div><label className="label-title">الشهادة</label>
                                            <select name="degreeName" required value={formData.degreeName} onChange={handleChange}>
                                                <option value="">-- اختر --</option>
                                                {["ليسانس", "ماستر", "دراسات عليا", "مهندس"].map(d => <option key={d} value={d}>{d}</option>)}
                                            </select>
                                        </div>
                                        <div><label className="label-title">التخصص</label><input type="text" name="specialty" required value={formData.specialty} onChange={handleChange} /></div>
                                        <div><label className="label-title">رقم الشهادة</label><input type="text" name="degreeNum" required value={formData.degreeNum} onChange={handleChange} /></div>
                                        <div><label className="label-title">تاريخ التخرج</label><input type="date" name="graduationDate" required value={formData.graduationDate} onChange={handleChange} /></div>
                                        <div className="md:col-span-2"><label className="label-title">المؤسسة المسلمة</label><input type="text" name="issuingInstitution" required value={formData.issuingInstitution} onChange={handleChange} /></div>
                                        <div className="grid grid-cols-2 gap-2">
                                            <div><label className="label-title">سنة البداية</label><input type="text" name="startYear" maxLength="4" placeholder="2018" value={formData.startYear} onChange={handleChange} /></div>
                                            <div><label className="label-title">سنة النهاية</label><input type="text" name="endYear" maxLength="4" placeholder="2023" value={formData.endYear} onChange={handleChange} /></div>
                                        </div>
                                        <div><label className="label-title">التقدير</label>
                                            <select name="degreeGrade" value={formData.degreeGrade} onChange={handleChange}>
                                                <option value="">-- اختر --</option>
                                                {["مقبول", "حسن", "حسن جداً", "امتياز"].map(g => <option key={g} value={g}>{g}</option>)}
                                            </select>
                                        </div>
                                        <div className="md:col-span-2 border-t pt-4 grid grid-cols-2 gap-4">
                                            <label className="flex items-center gap-2 font-bold cursor-pointer"><input type="checkbox" name="isEnsaGraduate" checked={formData.isEnsaGraduate} onChange={handleChange} /> خريج مدرسة عليا</label>
                                            <label className="flex items-center gap-2 font-bold cursor-pointer"><input type="checkbox" name="isFirstInClass" checked={formData.isFirstInClass} onChange={handleChange} /> الأول في الدفعة</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {step === 3 && (
                            <div className="animate-fade-in space-y-6">
                                <div className="form-section">
                                    <h2 className="section-header">4. المسار الدراسي (كشوف النقاط)</h2>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                        <div><label className="label-title">المعدل العام للمسار</label><input type="text" name="gpa" placeholder="00.00" value={formData.gpa} onChange={handleChange} /></div>
                                        <div><label className="label-title">علامة المذكرة (إن وجدت)</label><input type="text" name="thesisGrade" value={formData.thesisGrade} onChange={handleChange} /></div>
                                    </div>
                                    <div className="overflow-x-auto rounded-xl border-2 border-slate-200">
                                        <table className="w-full text-center font-bold">
                                            <thead className="bg-slate-800 text-white">
                                                <tr><th className="p-4">السنة</th><th className="p-4">س 1</th><th className="p-4">س 2</th><th className="p-4">السنوي</th></tr>
                                            </thead>
                                            <tbody className="divide-y divide-slate-200">
                                                {[1, 2, 3, 4, 5].map((y, idx) => (
                                                    <tr key={y}>
                                                        <td className="p-4 bg-slate-50">السنة {y}</td>
                                                        <td><input type="text" className="border-none text-center bg-transparent" value={formData.semesters[idx].s1} onChange={(e) => handleSemesterChange(idx, 's1', e.target.value)} /></td>
                                                        <td><input type="text" className="border-none text-center bg-transparent" value={formData.semesters[idx].s2} onChange={(e) => handleSemesterChange(idx, 's2', e.target.value)} /></td>
                                                        <td><input type="text" className="border-none text-center bg-transparent" value={formData.semesters[idx].annual} onChange={(e) => handleSemesterChange(idx, 'annual', e.target.value)} /></td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        )}

                        {step === 4 && (
                            <div className="animate-fade-in space-y-6">
                                <div className="form-section">
                                    <h2 className="section-header">5. شهادات عليا ومنشورات</h2>
                                    <div className="space-y-6">
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 pb-6 border-b-2 border-dashed">
                                            <h3 className="md:col-span-2 font-black text-blue-800">شهادة عليا إضافية:</h3>
                                            <div><label className="label-title">اسم الشهادة</label><input type="text" name="otherDegreeName" value={formData.otherDegreeName} onChange={handleChange} /></div>
                                            <div><label className="label-title">التخصص</label><input type="text" name="otherDegreeSpecialty" value={formData.otherDegreeSpecialty} onChange={handleChange} /></div>
                                            <div><label className="label-title">الجهة المسلمة</label><input type="text" name="otherDegreeIssuer" value={formData.otherDegreeIssuer} onChange={handleChange} /></div>
                                            <div className="grid grid-cols-2 gap-2">
                                                <div><label className="label-title">من سنة</label><input type="text" name="otherDegreeFromYear" value={formData.otherDegreeFromYear} onChange={handleChange} /></div>
                                                <div><label className="label-title">إلى سنة</label><input type="text" name="otherDegreeToYear" value={formData.otherDegreeToYear} onChange={handleChange} /></div>
                                            </div>
                                        </div>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 pt-4">
                                            <h3 className="md:col-span-2 font-black text-blue-800">المنشورات العلمية:</h3>
                                            <div><label className="label-title">طبيعة العمل (مقال/ملتقى...)</label><input type="text" name="publicationNature" value={formData.publicationNature} onChange={handleChange} /></div>
                                            <div><label className="label-title">تاريخ النشر</label><input type="date" name="publicationDate" value={formData.publicationDate} onChange={handleChange} /></div>
                                            <div><label className="label-title">اسم المجلة</label><input type="text" name="journalName" value={formData.journalName} onChange={handleChange} /></div>
                                            <div><label className="label-title">رابط النشر (URL)</label><input type="text" name="publicationLink" dir="ltr" value={formData.publicationLink} onChange={handleChange} /></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {step === 5 && (
                            <div className="animate-fade-in space-y-6">
                                <div className="form-section">
                                    <h2 className="section-header">6. الخبرة المهنية والوضعية الحالية</h2>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 pb-6 border-b-2 border-dashed">
                                        <h3 className="md:col-span-2 font-black text-blue-800">الخبرة المهنية السابقة:</h3>
                                        <div><label className="label-title">الوظيفة</label><input type="text" name="expJob" value={formData.expJob} onChange={handleChange} /></div>
                                        <div><label className="label-title">المؤسسة</label><input type="text" name="expInstitution" value={formData.expInstitution} onChange={handleChange} /></div>
                                        <div className="grid grid-cols-2 gap-2">
                                            <div><label className="label-title">من تاريخ</label><input type="date" name="expFrom" value={formData.expFrom} onChange={handleChange} /></div>
                                            <div><label className="label-title">إلى تاريخ</label><input type="date" name="expTo" value={formData.expTo} onChange={handleChange} /></div>
                                        </div>
                                        <div className="md:col-span-2"><label className="label-title">سبب إنهاء العلاقة</label><input type="text" name="expEndReason" value={formData.expEndReason} onChange={handleChange} /></div>
                                    </div>

                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 pt-6">
                                        <div className="md:col-span-2"><label className="flex items-center gap-2 font-bold cursor-pointer p-4 border-2 rounded-xl bg-blue-50 border-blue-200"><input type="checkbox" name="isEmployed" checked={formData.isEmployed} onChange={handleChange} /> هل تشغل وظيفة حالياً؟</label></div>
                                        {formData.isEmployed && (
                                            <div className="md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4 animate-fade-in">
                                                <div><label className="label-title">الرتبة الحالية</label><input type="text" name="currentRank" required={formData.isEmployed} value={formData.currentRank} onChange={handleChange} /></div>
                                                <div><label className="label-title">تاريخ أول تعيين</label><input type="date" name="firstAppointmentDate" value={formData.firstAppointmentDate} onChange={handleChange} /></div>
                                                <div><label className="label-title">هاتف الإدارة</label><input type="text" name="adminPhone" required={formData.isEmployed} value={formData.adminPhone} onChange={handleChange} /></div>
                                                <div><label className="label-title">عنوان الإدارة</label><input type="text" name="adminAddress" required={formData.isEmployed} value={formData.adminAddress} onChange={handleChange} /></div>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}

                        {step === 6 && (
                            <div className="animate-fade-in space-y-6">
                                <div className="form-section">
                                    <h2 className="section-header">7. مراجعة الوثائق والبريد</h2>
                                    <div className="grid grid-cols-1 gap-6">
                                        <div><label className="label-title text-blue-800">البريد الإلكتروني (هام للرد)</label><input type="email" name="email" required value={formData.email} onChange={handleChange} /></div>
                                        <div className="border-t-2 pt-6">
                                            <h3 className="font-bold mb-4 text-slate-700">الوثائق التي سيتم التأشير عليها تلقائياً (سيتم إرسال تقرير نصي شامل بكل البيانات):</h3>
                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                                {["بطاقة الإقامة", "وثيقة الخدمة الوطنية", "نسخة من الشهادة", "كشوف النقاط للمسار الدراسي", "شهادات العمل (الخبرة)", "ملف المنشورات والشهادات العليا", "ترخيص المشاركة (للموظفين)"].map(doc => (
                                                    <label key={doc} className={`flex items-center gap-3 p-4 border-2 rounded-xl transition-all ${formData.attachedDocs.includes(doc) ? 'bg-green-50 border-green-600 shadow-md' : 'bg-slate-50 border-slate-200 opacity-50'}`}>
                                                        <input type="checkbox" checked={formData.attachedDocs.includes(doc)} readOnly className="w-5 h-5" />
                                                        <span className={`text-sm font-bold ${formData.attachedDocs.includes(doc) ? 'text-green-800' : 'text-slate-500'}`}>{doc}</span>
                                                    </label>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        <div className="flex justify-between items-center py-6">
                            {step > 1 && <button type="button" onClick={() => setStep(step - 1)} className="bg-slate-300 text-slate-800 px-10 py-4 rounded-xl font-black hover:bg-slate-400">السابق</button>}
                            {step < 6 ? (
                                <button type="button" onClick={() => setStep(step + 1)} className="mr-auto bg-blue-600 text-white px-10 py-4 rounded-xl font-black hover:bg-blue-700 shadow-xl">التالي</button>
                            ) : (
                                <button type="submit" disabled={isSubmitting} className={`mr-auto px-12 py-4 rounded-xl font-black transition-all ${isSubmitting ? 'bg-slate-400' : 'bg-green-600 text-white hover:bg-green-700 shadow-2xl'}`}>
                                    {isSubmitting ? 'جاري التحضير والإرسال...' : 'إرسال الملف النهائي'}
                                </button>
                            )}
                        </div>
                    </form>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

