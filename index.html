
<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>استمارة معلومات لمسابقة التوظيف - د.عبد المجيد</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800;900&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script>
      // إعدادات Firebase مع الرابط الذي أرسلته
      const firebaseConfig = {
        apiKey: "AIzaSyBdlRDPTQqY8lZvD4R7nneXAwPgRbxmm14",
        authDomain: "councour-59e43.firebaseapp.com",
        databaseURL: "https://councour-59e43-default-rtdb.firebaseio.com/", 
        projectId: "councour-59e43",
        storageBucket: "councour-59e43.firebasestorage.app",
        messagingSenderId: "492907661374",
        appId: "1:492907661374:web:31792fc3ab95d0e69ea96f"
      };

      firebase.initializeApp(firebaseConfig);
      const db = firebase.database();

      tailwind.config = {
        theme: {
          extend: {
            fontFamily: { sans: ['Tajawal', 'sans-serif'] },
            colors: {
              'dz-green': '#008568',
              'dz-green-dark': '#006b54',
              'admin-blue': '#0f172a',
            }
          },
        },
      }
    </script>
    <style>
      ::-webkit-scrollbar { width: 10px; }
      ::-webkit-scrollbar-track { background: #f8fafc; }
      ::-webkit-scrollbar-thumb { background: #008568; border-radius: 5px; }
      input, select { background-color: #ffffff !important; font-weight: 700 !important; border: 2px solid #cbd5e1 !important; }
      input:focus, select:focus { border-color: #008568 !important; box-shadow: 0 0 0 4px rgba(0, 133, 104, 0.1); }
      .loading-pulse { animation: pulse 1.5s infinite; }
      @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }
      .modal-bg { background: rgba(15, 23, 42, 0.85); backdrop-filter: blur(8px); }
    </style>
  </head>
  <body class="bg-slate-100 font-sans text-right text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
      const { useState } = React;

      const WILAYAS = ["01 أدرار", "02 الشلف", "03 الأغواط", "04 أم البواقي", "05 باتنة", "16 الجزائر", "31 وهران"]; // قائمة مختصرة للتجربة
      
      const InputField = ({ label, name, value, onChange, type="text", required=false, options=null, maxLength=null, placeholder="" }) => (
        <div className="flex flex-col mb-4">
          <label className="text-sm font-black mb-2">{label} {required && <span className="text-red-600">*</span>}</label>
          {options ? (
            <select name={name} value={value} onChange={onChange} required={required} className="p-4 rounded-xl border-2">
              <option value="">-- اختر --</option>
              {options.map(o => <option key={o} value={o}>{o}</option>)}
            </select>
          ) : (
            <input type={type} name={name} value={value} onChange={onChange} required={required} maxLength={maxLength} placeholder={placeholder} className="p-4 rounded-xl border-2" />
          )}
        </div>
      );

      const App = () => {
        const [formData, setFormData] = useState({
          wilaya: '', rank: '', nin: '', lastNameAr: '', firstNameAr: '', phone: '', email: '', status: 'قيد الانتظار'
        });
        const [isSubmitting, setIsSubmitting] = useState(false);
        const [showSuccess, setShowSuccess] = useState(false);

        const handleChange = (e) => {
          const { name, value } = e.target;
          setFormData(prev => ({ ...prev, [name]: value }));
        };

        const handleSubmit = (e) => {
          e.preventDefault();
          setIsSubmitting(true);

          const submission = {
            ...formData,
            submissionDate: new Date().toLocaleString('ar-DZ'),
            timestamp: firebase.database.ServerValue.TIMESTAMP
          };

          // الإرسال الفعلي لـ Realtime Database
          db.ref('submissions').push(submission)
            .then(() => {
              setIsSubmitting(false);
              setShowSuccess(true);
            })
            .catch((err) => {
              setIsSubmitting(false);
              alert("فشل الإرسال: " + err.message);
            });
        };

        return (
          <div className="min-h-screen pb-20">
            <header className="bg-admin-blue text-white p-10 text-center shadow-xl mb-10">
              <h1 className="text-4xl font-black mb-2">استمارة التوظيف الإلكترونية</h1>
              <p className="text-dz-green font-bold">بوابة د.عبد المجيد - حفظ سحابي مباشر</p>
            </header>

            <main className="max-w-4xl mx-auto px-4">
              <form onSubmit={handleSubmit} className="bg-white p-8 rounded-[2rem] shadow-sm border-2">
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <InputField label="الولاية" name="wilaya" required value={formData.wilaya} onChange={handleChange} options={WILAYAS} />
                  <InputField label="الرتبة" name="rank" required value={formData.rank} onChange={handleChange} options={['أستاذ ابتدائي', 'أستاذ متوسط', 'أستاذ ثانوي']} />
                  <InputField label="رقم التعريف الوطني (NIN)" name="nin" required maxLength={18} value={formData.nin} onChange={handleChange} />
                  <InputField label="اللقب (عربي)" name="lastNameAr" required value={formData.lastNameAr} onChange={handleChange} />
                  <InputField label="الاسم (عربي)" name="firstNameAr" required value={formData.firstNameAr} onChange={handleChange} />
                  <InputField label="رقم الهاتف" name="phone" required maxLength={10} value={formData.phone} onChange={handleChange} />
                  <div className="md:col-span-2">
                    <InputField label="البريد الإلكتروني" name="email" type="email" required value={formData.email} onChange={handleChange} />
                  </div>
                </div>

                <button type="submit" disabled={isSubmitting} className={`w-full mt-8 bg-dz-green text-white py-6 rounded-2xl text-2xl font-black shadow-lg transition-transform hover:scale-[1.02] ${isSubmitting ? 'loading-pulse' : ''}`}>
                  {isSubmitting ? 'جاري الحفظ سحابياً...' : 'إرسال الملف الآن'}
                </button>
              </form>
            </main>

            {showSuccess && (
              <div className="fixed inset-0 z-50 flex items-center justify-center p-4 modal-bg">
                <div className="bg-white rounded-[3rem] p-12 text-center max-w-lg shadow-2xl">
                  <div className="text-dz-green text-6xl mb-6">✓</div>
                  <h2 className="text-3xl font-black mb-4">تم التسجيل بنجاح!</h2>
                  <p className="text-slate-600 font-bold mb-8">لقد استلمنا ملفك الإلكتروني عبر السحابة بنجاح.</p>
                  <button onClick={() => { setShowSuccess(false); window.location.reload(); }} className="bg-dz-green text-white px-10 py-4 rounded-xl font-bold">إغلاق</button>
                </div>
              </div>
            )}
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>
